<!DOCTYPE html>
<html>
<head>
<title>My Profile</title>
<style>
body{background:#f2f6ff;font-family:Arial}
.box{max-width:800px;margin:40px auto;background:#fff;padding:30px;border-radius:12px}
h2{color:#0a2a66;text-align:center}
.section{margin-top:30px;padding-top:20px;border-top:1px solid #ddd}
label{font-weight:bold}
input{width:100%;padding:10px;margin:6px 0 12px}
button{padding:10px 20px;background:#134db8;color:#fff;border:none;border-radius:6px;cursor:pointer}
button:hover{background:#0a2a66}
a{display:inline-block;margin-top:15px;color:#134db8;text-decoration:none;font-weight:bold}
.flash{color:green;text-align:center;margin-bottom:15px}
</style>
</head>

<body>

<div class="box">
<h2>My Profile</h2>

{% with messages = get_flashed_messages() %}
  {% if messages %}
    <div class="flash">{{ messages[0] }}</div>
  {% endif %}
{% endwith %}

<!-- VIEW PROFILE -->
<p><b>Name:</b> {{ user.first_name }} {{ user.last_name }}</p>
<p><b>Email:</b> {{ user.email }}</p>
<p><b>Phone:</b> {{ user.phone }}</p>
<p><b>Address:</b> {{ user.address }}</p>

<!-- EDIT PROFILE -->
<div class="section">
<h3>Edit Profile</h3>
<form method="POST">
<input type="hidden" name="action" value="edit_profile">

<label>First Name</label>
<input name="first_name" value="{{ user.first_name }}" required>

<label>Last Name</label>
<input name="last_name" value="{{ user.last_name }}" required>

<label>Phone</label>
<input name="phone" value="{{ user.phone }}" required>

<label>Address</label>
<input name="address" value="{{ user.address }}" required>

<button>Update Profile</button>
</form>
</div>

<!-- CHANGE PASSWORD -->
<div class="section">
<h3>Change Password</h3>
<form method="POST">
<input type="hidden" name="action" value="change_password">

<label>Old Password</label>
<input type="password" name="old_password" required>

<label>New Password</label>
<input type="password" name="new_password" required>

<button>Change Password</button>
</form>
</div>

<!-- DOWNLOAD HISTORY -->
<div class="section">
<h3>Transaction History</h3>
<a href="/download_history">⬇️ Download Transaction History</a>
</div>

<a href="/dashboard">⬅ Back to Dashboard</a>
</div>

</body>
</html>
